<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <title>Registro de Gastos</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='Estilos/variables.css') }}" />
  <link rel="stylesheet" href="{{ url_for('static', filename='Estilos/estilos.css') }}" />
  <link rel="stylesheet" href="{{ url_for('static', filename='Estilos/gastos.css') }}" />
  <link rel="stylesheet" href="{{ url_for('static', filename='Estilos/botonvol.css') }}" />
  <style>
    .layout-dos-columnas {
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 60vh;
    }

    .columna-izquierda {
      width: 100%;
      max-width: 600px;
    }

    .formulario-login {
      width: 100%;
    }

    .grupo-botones {
      display: flex;
      flex-direction: column;
      gap: 15px;
      margin-top: 25px;
    }

    .boton {
      width: 100%;
      text-align: center;
    }
  </style>
</head>

<body>
  <h1 style="text-align:center;">üí∏ Registro de Gastos</h1>

  <!-- Men√∫ bot√≥n superior derecho -->
  <div class="layout-dos-columnas">
    <!-- Formulario de gastos -->
    <div class="columna-izquierda">
      <div class="formulario-login">
        <h2 class="titulo-login">üßæ Nuevo Gasto</h2>
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            {% for category, message in messages %}
              <div class="alert alert-{{ category }}">{{ message }}</div>
            {% endfor %}
          {% endif %}
        {% endwith %}
        <form id="formGasto" method="POST" action="{{ url_for('gastos') }}">
          <fieldset class="grupo-campos">
            <legend class="subtitulo">Informaci√≥n del gasto</legend>

            <label class="etiqueta" for="fecha">Fecha:</label>
            <input type="date" id="fecha" name="Fecha" class="campo-input" required>

            <label class="etiqueta" for="descripcion">Descripci√≥n:</label>
            <input type="text" id="descripcion" name="Descripcion" class="campo-input" required>

            <label class="etiqueta" for="valor">Valor:</label>
            <input type="number" id="valor" name="Valor" class="campo-input" required>

            <!-- Categor√≠a -->
            <label class="etiqueta" for="categoria">Categor√≠a:</label>
            <select id="categoria" name="Id_categoria" class="campo-input" required>
              <option value="">-- Selecciona una categor√≠a --</option>
              {% for cat in categorias %}
                <option value="{{ cat['Id_categoria'] }}">{{ cat['Categoria_principal'] }}</option>
              {% endfor %}
            </select>

            <!-- Subcategor√≠a -->
            <label class="etiqueta" for="subcategoria">Subcategor√≠a:</label>
            <select id="subcategoria" name="Id_subcategoria" class="campo-input" required>
              <option value="">-- Selecciona una subcategor√≠a --</option>
              {% for sub in subcategorias %}
                <option value="{{ sub['Id_subcategoria'] }}" data-categoria="{{ sub['Id_categoria'] }}">{{ sub['Nombre'] }}</option>
              {% endfor %}
            </select>
          </fieldset>

          <div class="grupo-botones">
            <button type="submit" class="boton">üíæ Guardar gasto</button>
            <a href="{{ url_for('tabla_gastos') }}">
                        <button class="boton" type="button">Ver mis gastos</button>
            </a>
          </div>  
        </form>
      </div>
    </div>
  </div>
  <button class="boton-volver-fijo" onclick="window.location.href='{{ url_for('principal') }}'">
    <span class="icono-flecha">‚¨Ö</span> Volver a la principal
  </button>
  <script>
    function toggleMenu() {
      const menu = document.getElementById('menuOpciones');
      menu.style.display = menu.style.display === 'flex' ? 'none' : 'flex';
    }
document.getElementById('categoria').addEventListener('change', function() {
  var categoriaId = this.value;
  var subcatSelect = document.getElementById('subcategoria');
  var options = subcatSelect.querySelectorAll('option[data-categoria]');
  subcatSelect.value = "";
  options.forEach(function(opt) {
    opt.style.display = (opt.getAttribute('data-categoria') === categoriaId) ? 'block' : 'none';
  });
});
window.addEventListener('DOMContentLoaded', function() {
  // Oculta todas las subcategor√≠as al inicio
  var subcatSelect = document.getElementById('subcategoria');
  var options = subcatSelect.querySelectorAll('option[data-categoria]');
  options.forEach(function(opt) {
    opt.style.display = 'none';
  });
});
  </script>
</body>

</html>